/*
Copyright 2011 Matt DeVore

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

#define IDS_OLDDX                       18
#define IDS_FORCEPICKUPSP               19
#define IDS_NEWPLAYER                   20
#define IDS_OLDPLAYER                   21
#define IDS_FORCEPICKUPMP               22
#define IDS_NORECORDS                   23
#define IDS_NODLL                       24
#define IDS_PAUSE                       25
#define IDS_BESTTIMEFORMAT              26
#define IDS_BESTSCOREFORMAT             27
#define IDS_RECORDSUMMARY               28
#define IDI_APPICON                     102
#define IDS_DIFFICULTYSELECTCAPTION     116
#define IDS_SELECTCONNECTIONMETHODCAPTION 120
#define IDS_ENTERNAMECAPTION            121
#define IDS_COULDNOTCONNECT             133
#define IDS_GAMESLOTNAME11              133
#define IDS_GAMESLOTNAME12              134
#define IDS_NOCONNECTIONMETHODAVAILABLE 144
#define IDS_GUARANTEEDMSGON             153
#define IDS_GUARANTEEDMSGOFF            154
#define IDS_KILLEDYOURSELF              155
#define IDS_KILLED                      156
#define IDS_YOU                         157
#define IDS_YOUKILLED                   158
#define IDS_KILLEDTHEMSELVES            159
#define IDS_SPKILLED                    160
#define IDS_INVALIDSYNCRATE             161
#define IDS_BUDGETCUTS                  201
#define IDB_TURNER                      206
#define IDB_STORY                       207
#define IDD_CFG                         209

#define IDR_INTROMUSIC                  279
#define IDR_MENUMUSIC                   281
#define IDR_YOUWINTUNE                       283
#define IDR_MIDI2                       284
#define IDR_MIDI3                       285
#define IDR_MIDI4                       286
#define IDB_BITMAP1                     293
#define IDB_BITMAP2                     294
#define IDB_BITMAP3                     295
#define IDB_BITMAP4                     296
#define IDB_BITMAP5                     297
#define IDB_BITMAP6                     298
#define IDB_BITMAP7                     299
#define IDB_BITMAP8                     300
#define IDB_BITMAP9                     301
#define IDB_BITMAP10                    302
#define IDB_BITMAP11                    303
#define IDB_BITMAP12                    304
#define IDB_BITMAP13                    305
#define IDB_BITMAP14                    306
#define IDB_BITMAP15                    307
#define IDB_BITMAP16                    308
#define IDB_BITMAP17                    309
#define IDB_BITMAP18                    310
#define IDB_BITMAP19                    311
#define IDB_BITMAP20                    312
#define IDB_BITMAP21                    313
#define IDB_BITMAP22                    314
#define IDB_BITMAP23                    315
#define IDB_BITMAP24                    316
#define IDB_BITMAP25                    317
#define IDB_BITMAP26                    318
#define IDB_BITMAP27                    319
#define IDB_BITMAP28                    320
#define IDB_BITMAP29                    321
#define IDB_BITMAP30                    322
#define IDB_BITMAP31                    323
#define IDB_BITMAP32                    324
#define IDB_BITMAP33                    325
#define IDB_BITMAP34                    326
#define IDB_BITMAP35                    327
#define IDB_BITMAP36                    328
#define IDB_BITMAP37                    329
#define IDB_BITMAP38                    330
#define IDB_BITMAP39                    331
#define IDB_BITMAP40                    332
#define IDB_BITMAP41                    333
#define IDB_BITMAP42                    334
#define IDB_BITMAP43                    335
#define IDB_BITMAP44                    336
#define IDB_BITMAP45                    337
#define IDB_BITMAP46                    338
#define IDB_BITMAP47                    339
#define IDB_BITMAP48                    340
#define IDB_BITMAP49                    341
#define IDB_BITMAP50                    342
#define IDB_BITMAP51                    343
#define IDB_BITMAP52                    344
#define IDB_BITMAP53                    345
#define IDB_BITMAP54                    346
#define IDB_BITMAP55                    347
#define IDB_BITMAP56                    348
#define IDB_BITMAP57                    349
#define IDB_BITMAP58                    350
#define IDB_BITMAP59                    351
#define IDB_BITMAP60                    352
#define IDB_BITMAP61                    353
#define IDB_BITMAP62                    354
#define IDB_BITMAP63                    355
#define IDB_BITMAP64                    356
#define IDB_BITMAP65                    357
#define IDB_BITMAP66                    358
#define IDB_BITMAP67                    359
#define IDB_BITMAP68                    360
#define IDB_BITMAP69                    361
#define IDB_BITMAP70                    362
#define IDB_BITMAP71                    363
#define IDB_BITMAP72                    364
#define IDB_BITMAP73                    365
#define IDB_BITMAP74                    366
#define IDB_BITMAP75                    367
#define IDB_BITMAP76                    368
#define IDB_BITMAP77                    369
#define IDB_BITMAP78                    370
#define IDB_BITMAP79                    371
#define IDB_BITMAP80                    372
#define IDB_BITMAP81                    373
#define IDB_BITMAP82                    374
#define IDB_BITMAP83                    375
#define IDB_BITMAP84                    376
#define IDB_BITMAP85                    377
#define IDB_BITMAP86                    378
#define IDB_BITMAP87                    379
#define IDB_BITMAP88                    380
#define IDB_BITMAP89                    381
#define IDB_BITMAP90                    382
#define IDB_BITMAP91                    383
#define IDB_BITMAP92                    384
#define IDB_TITLETURN                   395
#define IDR_WELCOMEBOXMUSIC             397
#define IDR_LIGHTRAIN                   400
#define IDR_HEAVYRAIN                   401
#define IDR_CRICKETS                    402
#define IDR_THUNDER1                    403
#define IDR_THUNDER2                    404
#define IDR_THUNDER3                    405
#define IDB_BACKGROUND                  415
#define IDR_SPLASH                      416
#define IDR_FONT                        428
#define IDC_FPSF                        1000
#define IDC_SYNC                        1000
#define IDLAUNCH                        1001
#define IDQUIT                          1002
#define IDLAUNCHWITHOUTMUSIC            1005

// resources used only by the level maker
#define IDC_TURNER                      1112
#define IDC_SALLY                       1113
#define IDC_PISTOL                      1114
#define IDC_MILTON                      1115
#define IDC_MACHINEGUN                  1116
#define IDC_HEALTH                      1117
#define IDC_BAZOOKA                     1118
#define IDC_EVILTURNER                  1119
#define IDB_GENERICHEALTH               1120
#define IDB_GENERICMILTON               1121
#define IDB_GENERICSALLY                1122
#define IDB_GENERICTURNER               1123
#define IDB_GENERICBAZOOKA              1124
#define IDB_GENERICEVILTURNER           1125
#define IDB_GENERICMACHINEGUN           1126
#define IDB_GENERICPISTOL               1127

class CPowerUp;
class GfxPretty;
class GfxBasic;
class Gfx;

struct Context {
  typedef char Score[11];

  Character::Ptr hero;

  // the world coordinates which are in the center of the viewport or buffer
  FIXEDNUM center_screen_x;
  FIXEDNUM center_screen_y;

  unsigned short ammo[WEAPON_COUNT];

  FIXEDNUM AmmoAsPercentage(int weapon);

  Score score;
  int score_print_x;

  bool AmmoFull(int weapon);
  void AmmoAdd(int weapon, int amount);
  void AmmoReset();

  void Draw(unsigned int bmp, int x, int y);
  void DrawScale(unsigned int bmp, RECT *target);

  // changes the score by the difference specified.
  //  if a difference below zero is specified,
  //  the score is reduced.  If a difference
  //  above zero is specified, the score is increased
  //  if the difference specified is zero, the score
  //  is reset to zero
  void ChangeScore(int diff);
};

Context *GluContext();

bool GluInitialize(HINSTANCE hInstance_, HWND hWnd_);

void GluRelease();

/**
 * This function returns true if Glue has been
 * released and the app can quit without any
 * memory leak or anything bad like that
 * @return true iff the application can quit.
 */
bool GluCanQuit();


// this function plays the game (including the intro, endgame, menu
//  screen), and returns the handle of the main window
HWND GluMain();

// this function tells the user
//  about the feature which allows
//  the player to pickup a powerup
//  even when it is not needed
void GluPostForcePickupMessage();

// puts a text message at the top of the screen
//  if the previous message has not been up there for very long,
//  this function does nothing
void GluPostMessage(const char *str);

void GluPlaySound(int i, FIXEDNUM x_source, FIXEDNUM y_source);

// sets the music that should be played.
//  if music was disabled, this function does nothing
//  if the music specified is already playing, this fucntion
//   does nothing.
// one overided SetMusic function allows the caller to specify
//  the music in the form of an integer
// the other overided SetMusic function allows the caller to
//  specify the msuci the form of a string
void GluSetMusic(bool loop, WORD music_resource);
void GluSetMusic(bool loop, const char *music_resource);

// this will return a random spot in the level (for mp games)
//  that a player can start in without being trapped from everyone
//  else 
void GluGetRandomStartingSpot(POINT&);

// this function takes as parameter a reference to the movement
//  plans of a character.  If the character does not plan to walk
// through any walls, this function will detect it and leaves the
// plans unaltered otherwise, the function will make it so the
// character stops walking right before the wall by "filtering"
// plans.second to a valid destination 
void GluFilterMovement(const POINT *start, POINT *end);

void GluCharPress(char c);
void GluKeyPress(BYTE scan_code);
bool GluWalkingData(FIXEDNUM x,FIXEDNUM y);
void GluPostSPKilledMessage();
void GluInterpretDirection(BYTE d, FIXEDNUM& xf, FIXEDNUM& yf);
void GluStrLoad(unsigned int id, std::string& target);

// returns the amount a points a player gets when he picks up weapon
// type x 
int GluScoreDiffPickup(int x);

// returns the amount of points a player gets when he kills enemy of
// type x 
int GluScoreDiffKill(int x);

// constants having to do with how many bitmaps we have and
//  what the indices of the bitmaps are
const int BMP_BLOODSTAIN = 0;
const int BMP_BULLET = 1;
const int BMP_EXPLOSION = 2;
const int BMP_HEALTH = 3;
const int BMP_MENU = 4;
const int BMPSET_DECAPITATE = 5;
const int BMPSET_WEAPONS = 7;
const int BMPSET_PISTOL = 7;
const int BMPSET_MACHINEGUN = 11;
const int BMPSET_BAZOOKA = 15;
const int BMPSET_CHARACTERS = 19;
const int ANIMATIONFRAMESPERCHARACTER = 8;
const int RENDERED_DIRECTIONS = 4;

extern const char *WINDOW_CAPTION;

enum {DEAST, DNORTH, DWEST, DSOUTH, DNE, DNW, DSW, DSE};

